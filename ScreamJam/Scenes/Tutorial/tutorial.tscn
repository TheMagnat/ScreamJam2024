[gd_scene load_steps=16 format=3 uid="uid://b70sfx2l07fnh"]

[ext_resource type="Script" path="res://Scenes/Tutorial/tutorial.gd" id="1_bujhw"]
[ext_resource type="PackedScene" uid="uid://bn6kqsd0ifw51" path="res://Scenes/Map/map.tscn" id="1_c84bv"]
[ext_resource type="PackedScene" uid="uid://cdn2oqit1gq4v" path="res://Scenes/Demo/Test.tscn" id="2_86hwq"]
[ext_resource type="AudioStream" uid="uid://by6t6604jpris" path="res://Assets/SFX/tutorial/8bit_intro.ogg" id="4_1twop"]
[ext_resource type="AudioStream" uid="uid://dwe1jljijcfhh" path="res://Assets/SFX/tutorial/8bit_validate.ogg" id="4_kh0yp"]
[ext_resource type="AudioStream" uid="uid://nis7xan2np8n" path="res://Assets/SFX/tutorial/8bit_action.ogg" id="5_1kl2u"]
[ext_resource type="AudioStream" uid="uid://dn2ljmbfi1oif" path="res://Assets/SFX/tutorial/8bit_eye.ogg" id="6_vamv3"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_3donj"]
sky_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)
ground_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)

[sub_resource type="Sky" id="Sky_xp1a5"]
sky_material = SubResource("ProceduralSkyMaterial_3donj")

[sub_resource type="Environment" id="Environment_qenub"]
background_mode = 2
sky = SubResource("Sky_xp1a5")
tonemap_mode = 2
tonemap_exposure = 2.0
ssao_enabled = true
glow_enabled = true
volumetric_fog_enabled = true
volumetric_fog_density = 0.3005

[sub_resource type="CameraAttributesPractical" id="CameraAttributesPractical_2yjgx"]
dof_blur_far_enabled = true
dof_blur_far_distance = 6.0
dof_blur_near_enabled = true
dof_blur_near_distance = 0.01
dof_blur_near_transition = -1.0
dof_blur_amount = 0.2

[sub_resource type="LabelSettings" id="LabelSettings_8fo8y"]
font_size = 128

[sub_resource type="LabelSettings" id="LabelSettings_65laa"]
font_size = 80

[sub_resource type="Shader" id="Shader_csuka"]
code = "shader_type canvas_item;

uniform sampler2D viewport : hint_screen_texture, filter_nearest;

uniform float pixelize : hint_range(0.0, 1.0, 0.001);
uniform float blink : hint_range(0.0, 1.0, 0.001);

const vec2 offset = vec2(0.2, 0.2);

void fragment() {
	vec2 fact = vec2(144.0, 81.0) * pixelize;
	vec2 p = (UV * (vec2(1) + offset * 2.0)) - offset;
	if (p.x < 0.0 || p.y < 0.0 || p.x > 1.0 || p.y > 1.0) {
		COLOR.rgb = vec3(0.0);
	} else {
		COLOR = texture(viewport, vec2(float(int(p.x * fact.x))/fact.x, float(int(p.y * fact.y))/fact.y));
		
		vec2 CENTER = UV - vec2(0.5);
		vec2 c3 = vec2(CENTER.x * 0.5, CENTER.y);
		COLOR.rgb *= max(0.0, 1.0 - blink - length(c3 * blink * 4.0));
	}
}

"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_11ee7"]
shader = SubResource("Shader_csuka")
shader_parameter/pixelize = null
shader_parameter/blink = null

[node name="Tutorial" type="Node3D"]
script = ExtResource("1_bujhw")
nextScene = ExtResource("2_86hwq")

[node name="Map" parent="." instance=ExtResource("1_c84bv")]
mapFilePath = "res://Scenes/Map/MapFile/tutorial.txt"

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 2.5, 10)
current = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_qenub")
camera_attributes = SubResource("CameraAttributesPractical_2yjgx")

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = 100

[node name="Tutorial" type="Label" parent="CanvasLayer"]
offset_right = 1152.0
offset_bottom = 648.0
text = "TUTORIAL"
label_settings = SubResource("LabelSettings_8fo8y")
horizontal_alignment = 1
vertical_alignment = 1

[node name="Text" type="Label" parent="CanvasLayer"]
offset_right = 1152.0
offset_bottom = 648.0
label_settings = SubResource("LabelSettings_65laa")
horizontal_alignment = 1
vertical_alignment = 1

[node name="ColorRect" type="ColorRect" parent="CanvasLayer"]
material = SubResource("ShaderMaterial_11ee7")
offset_right = 1152.0
offset_bottom = 648.0

[node name="intro" type="AudioStreamPlayer" parent="."]
stream = ExtResource("4_1twop")
volume_db = -8.0

[node name="validate" type="AudioStreamPlayer" parent="."]
stream = ExtResource("4_kh0yp")
pitch_scale = 1.5

[node name="action" type="AudioStreamPlayer" parent="."]
stream = ExtResource("5_1kl2u")

[node name="eye" type="AudioStreamPlayer" parent="."]
stream = ExtResource("6_vamv3")
